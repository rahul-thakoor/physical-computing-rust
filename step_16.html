<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Using motors - </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="_FontAwesome/css/font-awesome.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="step_1.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><a href="step_2.html"><strong aria-hidden="true">2.</strong> What you will need</a></li><li><a href="step_3.html"><strong aria-hidden="true">3.</strong> GPIO pins</a></li><li><a href="step_4.html"><strong aria-hidden="true">4.</strong> Lighting an LED</a></li><li><a href="step_5.html"><strong aria-hidden="true">5.</strong> Switching an LED on and off</a></li><li><a href="step_6.html"><strong aria-hidden="true">6.</strong> Flashing an LED</a></li><li><a href="step_7.html"><strong aria-hidden="true">7.</strong> Using buttons to get input</a></li><li><a href="step_8.html"><strong aria-hidden="true">8.</strong> Manually controlling the LED</a></li><li><a href="step_9.html"><strong aria-hidden="true">9.</strong> Making a switch</a></li><li><a href="step_10.html"><strong aria-hidden="true">10.</strong> Using a buzzer</a></li><li><a href="step_11.html"><strong aria-hidden="true">11.</strong> Making traffic lights</a></li><li><a href="step_12.html"><strong aria-hidden="true">12.</strong> Using a light-dependent resistor</a></li><li><a href="step_13.html"><strong aria-hidden="true">13.</strong> Using a PIR sensor</a></li><li><a href="step_14.html"><strong aria-hidden="true">14.</strong> Using an ultrasonic distance sensor</a></li><li><a href="step_15.html"><strong aria-hidden="true">15.</strong> Analogue inputs</a></li><li><a href="step_16.html" class="active"><strong aria-hidden="true">16.</strong> Using motors</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title"></h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="step_16.html#using-motors" id="using-motors"><h2>Using motors</h2></a>
<p>Motors are great for physical computing: they allow you to turn a wheel forwards and backwards, or make something spin around.</p>
<p>A motor can't be controlled directly from the Raspberry Pi's GPIO pins, because it needs a variable supply of 5 volts. This means you need to power it separately. However, motor controller add-on boards can be used to provide this functionality.</p>
<p>In this guide, you'll be controlling two motors from your Raspberry Pi using Python on the desktop. First, it's best just to learn how to control the motor. Then, once you have it working, you could easily use your code to drive a Raspberry Pi-powered robot by detaching the monitor, mouse, and keyboard and building a robot around a chassis.</p>
<a class="header" href="step_16.html#h-bridge" id="h-bridge"><h3>H bridge</h3></a>
<p>A motor can be driven forwards or backwards depending on which way around current flows through it. However, it would be awkward to have to rewire a motor, every time you want to change the direction it spins. To overcome this issue, motor controller boards include an H bridge. An H bridge uses 4 transistors to allow digital control of which way current flows through the motor. Most H bridges also contain <em>flyback diodes</em>. A flyback diode prevents the voltage spike that is generated by the motor when it is no longer powered (but still spinning) from damaging delicate electronics.</p>
<p><img src="images/h-bridge.png" alt="H-Bridge" /></p>
<p><em>Image credit: <a href="https://en.wikipedia.org/wiki/H_bridge">Wikipedia</a>, CC BY-SA</em></p>
<a class="header" href="step_16.html#wiring" id="wiring"><h3>Wiring</h3></a>
<p>You'll need to wire up two motors and your battery pack using the motor controller.</p>
<ul>
<li>
<p>With your Pi switched off, mount your motor controller board on the GPIO pins:</p>
<p><img src="images/mcb.png" alt="Motor controller board" /></p>
</li>
<li>
<p>Connect a battery pack to the power ports of the motor controller, connecting the positive (red) battery wire to the positive (+) power terminal on the motor controller, and the negative (black) battery wire to the negative (-) power terminal on the motor controller, and connect two motors:</p>
<p><img src="images/mcb-wiring.png" alt="Connect battery pack" /></p>
</li>
<li>
<p>You'll need to know which GPIO pins your motor controller uses. Refer to the board's documentation. This will usually be described as Motor A and Motor B, or MA1, MA2, MB1, and MB2. Make a note of these pin numbers. If you're not sure which is which, you can investigate this next.</p>
</li>
</ul>
<a class="header" href="step_16.html#output-devices" id="output-devices"><h3>Output devices</h3></a>
<p>First, you should learn to control motors by controlling the pins individually.</p>
<ul>
<li>
<p>Boot the Pi and open Python 3.</p>
</li>
<li>
<p>In the shell, enter the following line to import <code>OutputDevice</code> from the GPIO Zero library:</p>
<pre><code class="language-python">from gpiozero import OutputDevice
</code></pre>
<p>After each line, press <strong>Enter</strong> and the command will be executed immediately.</p>
</li>
<li>
<p>Now create an instance of an <code>OutputDevice</code> on each of the pins for one motor:</p>
<pre><code class="language-python">a = OutputDevice(4)
b = OutputDevice(14)
</code></pre>
</li>
<li>
<p>Now you should be able to make the motor spin by turning one of the pins on:</p>
<pre><code class="language-python">a.on()
</code></pre>
<p>The motor should now be spinning! If not, check you are addressing the right pin numbers. The two pins should be connected to the same motor. Also, check your wiring and your batteries.</p>
</li>
<li>
<p>Now try turning that pin off, and turning the other pin on:</p>
<pre><code class="language-python">a.off()
b.on()
</code></pre>
<p>The motor should now be spinning in the opposite direction.</p>
</li>
<li>
<p>To stop the motor, just make sure both pins are off:</p>
<pre><code class="language-python">a.off()
b.off()
</code></pre>
</li>
<li>
<p>Now try the same with the second motor:</p>
<pre><code class="language-python">c = OutputDevice(17)
d = OutputDevice(27)
c.on()
</code></pre>
</li>
<li>
<p>And backwards:</p>
<pre><code class="language-python">c.off()
d.on()
</code></pre>
</li>
<li>
<p>And stop:</p>
<pre><code class="language-python">c.off()
d.off()
</code></pre>
</li>
<li>
<p>Try controlling one of the motors in a loop:</p>
<pre><code class="language-python">from time import sleep

for i in range(5):
    b.off()
    a.on()
    sleep(5)
    a.off()
    b.on()
    sleep(5)
b.off()
</code></pre>
<p>The motor should now spin forwards for 5 seconds then backwards for 5 seconds, repeat this 5 times, and then stop.</p>
</li>
</ul>
<a class="header" href="step_16.html#pwm" id="pwm"><h3>PWM</h3></a>
<p>So far, you have used simple on/off commands to control your motors. PWM (pulse-width modulation) allows you to control the speed. The <code>on()</code> function sets the motor to go at full speed, but you can control this to make the motor go at a fraction of this speed.</p>
<ul>
<li>
<p>Since you're going to reuse the same pins in a different way, you'll have to close the connections to the pins. The easiest way to do that is to restart the Python shell by clicking <strong>Shell &gt; Restart shell</strong>.</p>
</li>
<li>
<p>Import the <code>PWMOutputDevice</code> class:</p>
<pre><code class="language-python">from gpiozero import PWMOutputDevice
</code></pre>
</li>
<li>
<p>Create new connections to each of your pins as before, but using <code>PWMOutputDevice</code>:</p>
<pre><code class="language-python">a = PWMOutputDevice(4)
b = PWMOutputDevice(14)
c = PWMOutputDevice(17)
d = PWMOutputDevice(27)
</code></pre>
</li>
<li>
<p>You can still use <code>a.on()</code>, <code>a.off()</code> and so on, but you can also set the device's value to a number between <code>0</code> and <code>1</code>. Try half:</p>
<pre><code class="language-python">a.value = 0.5
</code></pre>
<p>The motor should now be spinning at half speed.</p>
</li>
<li>
<p>To turn the motor in the opposite direction, turn <code>a</code> off (or set its value to <code>0</code>) and set <code>b</code>'s value to <code>0.5</code>:</p>
<pre><code class="language-python">a.value = 0
b.value = 0.5
</code></pre>
<p>The motor should now be spinning backwards at half speed.</p>
</li>
<li>
<p>Try controlling both motors at different speeds to compare:</p>
<pre><code class="language-python">a.value = 0.5
b.value = 0
c.value = 1
d.value = 0
</code></pre>
</li>
<li>
<p>Try increasing the speed in a loop:</p>
<pre><code class="language-python">b.off()
d.off()
for i in range(1, 11):
    speed = i / 10
    print(speed)
    a.value = speed
    c.value = speed
    sleep(0.5)
</code></pre>
<p>The motors should now speed up from 0 (stopped) to 0.1, 0.2 and up to 1.</p>
<p>Be aware, though, that the motor may not move until it gets above a certain speed, as there may not be enough power to engage it.</p>
</li>
</ul>
<a class="header" href="step_16.html#motor-class" id="motor-class"><h3>Motor class</h3></a>
<p>Now you've learned how setting pins high and low can control a motor, you should proceed to using the built-in <code>Motor</code> class; this has all the functionality you just learned about, provided in a simple way, including PWM for speed.</p>
<ul>
<li>
<p>Restart the shell again (<strong>Ctrl + F6</strong>).</p>
</li>
<li>
<p>Import the <code>Motor</code> class:</p>
<pre><code class="language-python">from gpiozero import Motor
</code></pre>
</li>
<li>
<p>Now create a <code>Motor</code> instance using the pin numbers for each motor:</p>
<pre><code class="language-python">motor1 = Motor(4, 14)
motor2 = Motor(17, 27)
</code></pre>
<p>Note: to make it easier to see which pin is which, you can use <code>Motor(forward=4, backward=14)</code> for future reference.</p>
</li>
<li>
<p>Now drive one of the motors forward using the following code:</p>
<pre><code class="language-python">motor1.forward()
</code></pre>
</li>
<li>
<p>And the other backwards:</p>
<pre><code class="language-python">motor2.backward()
</code></pre>
</li>
<li>
<p>Or try half speed:</p>
<pre><code class="language-python">motor1.forward(0.5)
motor2.backward(0.5)
</code></pre>
</li>
<li>
<p>The <code>Motor</code> class also allows you to reverse the motor's direction. Try using this loop:</p>
<pre><code class="language-python">motor1.forward()
motor2.backward()
while True:
    sleep(5)
    motor1.reverse()
    motor2.reverse()
</code></pre>
<p>This will make the motors spin in opposite directions, then switch every five seconds. Press <strong>Ctrl + C</strong> to exit the loop.</p>
</li>
<li>
<p>Now stop the motors:</p>
<pre><code class="language-python">motor1.stop()
motor2.stop()
</code></pre>
</li>
</ul>
<a class="header" href="step_16.html#robot-class" id="robot-class"><h3>Robot class</h3></a>
<p>If you had a robot with two wheels you would want to control the two motors together, rather than separately, just like you did for the two pins of each motor. Luckily, there's also a <code>Robot</code> class in GPIO Zero.</p>
<ul>
<li>
<p>Restart the shell again (<strong>Ctrl + F6</strong>).</p>
</li>
<li>
<p>Import the <code>Robot</code> class:</p>
<pre><code class="language-python">from gpiozero import Robot
</code></pre>
</li>
<li>
<p>Now create a <code>Robot</code> instance using the pin numbers for each motor:</p>
<pre><code class="language-python">robot = Robot((4, 14), (17, 27))
</code></pre>
<p>Note: to make it easier to see which pin is which, you can use <code>Robot(left=(4, 14), right=(17, 27))</code> for future reference.</p>
</li>
<li>
<p>Now drive one of the motors forward using the following code:</p>
<pre><code class="language-python">robot.forward()
</code></pre>
<p>Both motors should now be driving forwards.</p>
</li>
<li>
<p>And backwards:</p>
<pre><code class="language-python">robot.backward()
</code></pre>
<p>Both motors should now be driving backwards.</p>
</li>
<li>
<p>Try reverse a few times:</p>
<pre><code class="language-python">robot.reverse()
robot.reverse()
robot.reverse()
</code></pre>
</li>
<li>
<p>Or try half speed:</p>
<pre><code class="language-python">robot.forward(0.5)
</code></pre>
</li>
<li>
<p>That's not all! What would happen if the left wheel went forwards and the right wheel went backwards? The robot would turn right. Try it:</p>
<pre><code class="language-python">robot.right()
</code></pre>
</li>
<li>
<p>Then try this:</p>
<pre><code class="language-python">robot.left()
</code></pre>
</li>
<li>
<p>Now stop the robot:</p>
<pre><code class="language-python">robot.stop()
</code></pre>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="step_15.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="step_15.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        

        

        
        <script src="searchindex.js" type="text/javascript" charset="utf-8"></script>
        
        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

    </body>
</html>
