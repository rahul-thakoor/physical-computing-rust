<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Using an ultrasonic distance sensor - </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="_FontAwesome/css/font-awesome.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="step_1.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><a href="step_2.html"><strong aria-hidden="true">2.</strong> What you will need</a></li><li><a href="step_3.html"><strong aria-hidden="true">3.</strong> GPIO pins</a></li><li><a href="step_4.html"><strong aria-hidden="true">4.</strong> Lighting an LED</a></li><li><a href="step_5.html"><strong aria-hidden="true">5.</strong> Switching an LED on and off</a></li><li><a href="step_6.html"><strong aria-hidden="true">6.</strong> Flashing an LED</a></li><li><a href="step_7.html"><strong aria-hidden="true">7.</strong> Using buttons to get input</a></li><li><a href="step_8.html"><strong aria-hidden="true">8.</strong> Manually controlling the LED</a></li><li><a href="step_9.html"><strong aria-hidden="true">9.</strong> Making a switch</a></li><li><a href="step_10.html"><strong aria-hidden="true">10.</strong> Using a buzzer</a></li><li><a href="step_11.html"><strong aria-hidden="true">11.</strong> Making traffic lights</a></li><li><a href="step_12.html"><strong aria-hidden="true">12.</strong> Using a light-dependent resistor</a></li><li><a href="step_13.html"><strong aria-hidden="true">13.</strong> Using a PIR sensor</a></li><li><a href="step_14.html" class="active"><strong aria-hidden="true">14.</strong> Using an ultrasonic distance sensor</a></li><li><a href="step_15.html"><strong aria-hidden="true">15.</strong> Analogue inputs</a></li><li><a href="step_16.html"><strong aria-hidden="true">16.</strong> Using motors</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title"></h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="step_14.html#using-an-ultrasonic-distance-sensor" id="using-an-ultrasonic-distance-sensor"><h2>Using an ultrasonic distance sensor</h2></a>
<p>In air, sound travels at a speed of 343 metres per second. An ultrasonic distance sensor sends out pulses of ultrasound which are inaudible to humans, and detects the echo that is sent back when the sound bounces off a nearby object. It then uses the speed of sound to calculate the distance from the object.</p>
<p><img src="images/ultrasonic-distance-sensor.png" alt="Ultrasonic distance sensor" /></p>
<a class="header" href="step_14.html#wiring" id="wiring"><h3>Wiring</h3></a>
<p>The circuit connects to two GPIO pins (one for echo, one for trigger), the ground pin, and a 5V pin. You'll need to use a pair of resistors (330Ω and 470Ω) as a potential divider:</p>
<p><img src="images/wiring-uds.png" alt="wiring" /></p>
<a class="header" href="step_14.html#code" id="code"><h3>Code</h3></a>
<p>To use the ultrasonic distance sensor in Python, you need to know which GPIO pins the echo and trigger are connected to.</p>
<ul>
<li>
<p>Open Python 3.</p>
</li>
<li>
<p>In the shell, enter the following line to import <code>DistanceSensor</code> from the GPIO Zero library:</p>
<pre><code class="language-python">from gpiozero import DistanceSensor
</code></pre>
<p>After each line, press <strong>Enter</strong> and the command will be executed immediately.</p>
</li>
<li>
<p>Create an instance of <code>DistanceSensor</code> using your echo and trigger pins:</p>
<pre><code class="language-python">ultrasonic = DistanceSensor(echo=17, trigger=4)
</code></pre>
</li>
<li>
<p>See what distance it shows:</p>
<pre><code class="language-python">ultrasonic.distance
</code></pre>
<p>You should see a number: this is the distance to the nearest object, in metres.</p>
</li>
<li>
<p>Try using a loop to print the distance continuously, while waving your hand in front of the sensor to alter the distance reading:</p>
<pre><code class="language-python">while True:
    print(ultrasonic.distance)
</code></pre>
<p>The value should get smaller the closer your hand is to the sensor. Press <strong>Ctrl + C</strong> to exit the loop.</p>
</li>
</ul>
<a class="header" href="step_14.html#ranges" id="ranges"><h3>Ranges</h3></a>
<p>As well as being able to see the distance value, you can also get the sensor to do things when the object is in or out of a certain range.</p>
<ul>
<li>
<p>Use a loop to print different messages when the sensor is in range or out of range:</p>
<pre><code class="language-python">while True:
    ultrasonic.wait_for_in_range()
    print(&quot;In range&quot;)
    ultrasonic.wait_for_out_of_range()
    print(&quot;Out of range&quot;)
</code></pre>
<p>Now wave your hand in front of the sensor; it should switch between showing the message &quot;In range&quot; and &quot;Out of range&quot; as your hand gets closer and further away from the sensor. See if you can work out the point at which it changes.</p>
</li>
<li>
<p>The default range threshold is 0.3m. This can be configured when the sensor is initiated:</p>
<pre><code class="language-python">ultrasonic = DistanceSensor(echo=17, trigger=4, threshold_distance=0.5)
</code></pre>
<p>Alternatively, this can be changed after the sensor is created, by setting the <code>threshold_distance</code> property:</p>
<pre><code class="language-python">ultrasonic.threshold_distance = 0.5
</code></pre>
</li>
<li>
<p>Try the previous loop again and observe the new range threshold.</p>
</li>
<li>
<p>The <code>wait_for</code> functions are <strong>blocking</strong>, which means they halt the program until they are triggered. Another way of doing something when the sensor goes in and out of range is to use <code>when</code> properties, which can be used to trigger actions in the background while other things are happening in the code.</p>
<p>First, you need to create a function for what you want to happen when the sensor is in range:</p>
<pre><code class="language-python">def hello():
    print(&quot;Hello&quot;)
</code></pre>
<p>Then set <code>ultrasonic.when_in_range</code> to the name of this function:</p>
<pre><code class="language-python">ultrasonic.when_in_range = hello
</code></pre>
</li>
<li>
<p>Add another function for when the sensor goes out of range:</p>
<pre><code class="language-python">def bye():
    print(&quot;Bye&quot;)

ultrasonic.when_out_of_range = bye
</code></pre>
<p>Now these triggers are set up, you'll see &quot;hello&quot; printed when your hand is in range, and &quot;bye&quot; when it's out of range.</p>
</li>
<li>
<p>You may have noticed that the sensor distance stopped at 1 metre. This is the default maximum and can also be configured on setup:</p>
<pre><code class="language-python">ultrasonic = DistanceSensor(echo=17, trigger=4, max_distance=2)
</code></pre>
<p>Or after setup:</p>
<pre><code class="language-python">ultrasonic.max_distance = 2
</code></pre>
</li>
<li>
<p>Try different values of <code>max_distance</code> and <code>threshold_distance</code>.</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="step_13.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="step_15.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="step_13.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="step_15.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        

        

        
        <script src="searchindex.js" type="text/javascript" charset="utf-8"></script>
        
        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

    </body>
</html>
